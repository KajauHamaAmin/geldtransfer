// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

enum TransferProvider {
  WU
  RIA
  MONEYGRAM
}

enum TransferType {
  SEND
  PAYOUT
  DEDUCTION
}

enum TransferStatus {
  posted
  cancelled
  deleted
}

model MoneyTransfer {
  id            String           @id @default(uuid())
  provider      TransferProvider
  type          TransferType
  amount        Decimal          @map("amount")
  fee           Decimal          @map("fee")
  reference     String?
  status        TransferStatus   @default(posted)
  cancelReason  String?
  createdById   String
  cancelledById String?
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  cancelledAt   DateTime?
}

model AuditLog {
  id        String   @id @default(uuid())
  userId    String
  action    String
  details   String?
  timestamp DateTime @default(now())
}

model User {
  id          String   @id @default(uuid())
  username    String   @unique
  email       String?  @unique
  name        String?
  role        String   @default("mitarbeiter") // "mitarbeiter", "manager", "admin", "owner"
  passwordHash String
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Schicht-Verwaltung
  shifts      Shift[]
  currentShift String?
}

model Shift {
  id        String   @id @default(uuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  startTime DateTime
  endTime   DateTime?
  status    String   @default("active") // "active", "completed", "cancelled"
  createdAt DateTime @default(now())
}
